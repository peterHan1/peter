<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="format-detection" content="telephone=no"/>
	<meta name="full-screen" content="yes">
	<meta name="x5-fullscreen" content="true"> 
	<title>协议支付</title>
	<script type="text/javascript" src="js/base.js"></script>
	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/agreement.css"/>
</head>
<body>
	<div class="max_width payment">
		<div class="pay_title">认证协议支付</div>
		<ul class="pay_list">
			<li>
				<div>
					<input type="text" placeholder="请输入姓名" class="name_inp"/>
				</div>
			</li>
			<li>
				<div>
					<input type="text" placeholder="请输入身份证号" maxlength="18" class="sfzCode_inp"/>
				</div>
			</li>
			<li>
				<div>
					<input type="tel" placeholder="请输入手机号" class="phone_inp"/>
				</div>
			</li>
		</ul>
		<ul class="pay_list phone_code">
			<li>
				<div>
					<input type="text" placeholder="请输入验证码" class="phoneCode_inp"/>
					<div class="get_code">获取验证码</div>
				</div>
			</li>
		</ul>
		<div class="pay_sub">
			<div >下一步</div>
		</div>
		<div class="pay_txt">
			<h3>温馨提示：</h3>
			<p>为了方便您还款，避免因还款问题造成征信受损，特为您开启快速还款通道，进行验证，若有疑问，请咨询门店工作人员。</p>
		</div>
	</div>
</body>
</html>
<script type="text/javascript" src="js/plug/jquery-2.1.0.min.js"></script>
<script type="text/javascript" src="js/plug/layer/layer.js"></script>
<script>
	$(function(){
		$(".pay_list input").keyup(function(){
			inp_val();
		});
		$(document).on("click",".sub_btn",function(){
			var phone = $(".phone_inp").val();
			var sfzCode = $(".sfzCode_inp").val();
			if(!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(sfzCode)){
				layer.msg('<i class="iconfont" style="font-size:0.36rem;">&#xe68d; &nbsp;</i>请输入正确的身份证号');
				return false; 
			}else if(!(/^1[34578]\d{9}$/.test(phone))){
				layer.msg('<i class="iconfont" style="font-size:0.36rem;">&#xe68d; &nbsp;</i>请输入正确的手机号');
				return false; 
			}else{
				//请求接口 跳转页面
				window.location.href='agreementFy.html';
			}

		});
		//获取短信验证码
		$(".get_code").on("click",function(){
			var phone = $(".phone_inp").val();
			if(!(/^1[34578]\d{9}$/.test(phone))){
				layer.msg('<i class="iconfont" style="font-size:0.36rem;">&#xe68d; &nbsp;</i>请输入正确的手机号');
			}else{
				if(countdown != 60){
					return false;
				}else{
					//请求接口 倒计时
					//防止多次点击出发 遮罩层加载
					var index = layer.load(1, {
						shade: [0.3,'#000']
					});
					//关闭加载层
					layer.close(index)
					
					settime();
				}
			}
		});
		var countdown=60; // 倒计时60秒
		function settime() {
			if (countdown == 0) { 
				$('.get_code').css({'color':'#ff7400'});
				$('.get_code').html("获取验证码");
				countdown = 60;
				return false;
			} else { 
				countdown--; 
				$('.get_code').css({'color':'#626262'});
				$('.get_code').html(countdown+'S');
			};
			setTimeout(function() { 
				settime() 
			},1000);	
		};
		function inp_val(){
			var name = $(".name_inp").val();
			var sfzCode = $(".sfzCode_inp").val();
			var phone = $(".phone_inp").val();
			var phoneCode = $(".phoneCode_inp").val();
			if(name != "" && sfzCode != "" && phone != "" && phoneCode != ""){
				$(".pay_sub div").addClass("sub_btn");
			}else{
				$(".pay_sub div").removeClass("sub_btn");
			}
		}
	})
</script>