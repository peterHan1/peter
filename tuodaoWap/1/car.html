<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no"/>
		<meta name="full-screen" content="yes">
    	<meta name="x5-fullscreen" content="true">
		<title>申请借款</title>
		<link rel="stylesheet" href="car/reset.css" />
		<link rel="stylesheet" href="car/city.css" />
		<script src='js/jquery-2.1.0.min.js'></script>
		<script src="js/base.js"></script>
		<style>
			input::-webkit-input-placeholder{color: #D3D3D3;}
		　　input:-moz-placeholder{color:#D3D3D3;}
		　　input::-moz-placeholder{color:#D3D3D3;}
		　　input:-ms-input-placeholder{color:#D3D3D3;}
			b { font-weight:normal;}
			html,body{background-color:#FBFAFA;height:100%;}
			.fl{float:left;}
			.fr{float:right;}
			.max_width{height:100%;overflow: hidden;position: relative;}
			.box{width:200%;height:100%;overflow:hidden;transition: all 1s;-moz-transition: all 1s;-webkit-transition: all 1s; -o-transition:all 1s;position: absolute;top:0;left:0;}
			.loan_box{width:50%;font-size:0.2rem;height:100%;}
			.loan_box .loan_fill{margin-top:0.2rem;}
			.loan_box .loan_fill .loan_litxt{background-color:#FBFAFA;border:none;color:#D3D3D3;}
			.loan_box .loan_fill ul li{width: 94%;padding:0 3%;height: 1rem;line-height:1rem;border-bottom: 1px solid #cdcdcd;background-color:#fff;overflow:hidden;}
			.loan_box .loan_fill ul li input{width:70%;height:100%;border:none;font-size:0.16rem;outline:none;float: left;}
			.loan_box .loan_fill ul li span{width:20%;font-size:0.2rem;float: left;}
			.loan_box .loan_fill ul li b{width:75%;color:#D3D3D3;float: left;}
			.loan_box .loan_fill ul li i{font-size:0.3rem;float: right;}
			.loan_box .loan_fill ul li .code_btn{width:10%;}
			.loan_box .sub_loan{margin-top:1rem;text-align:center;}
			.loan_box .sub_loan a{display:inline-block;color:#333;width:50%;height:0.8rem;text-align:center;line-height:0.8rem;border:1px solid #ededed;border-radius:5px;}
			.car_list_box{width:50%;height:100%;font-size:0.2rem;}
			.car_list_box .car_list_nav{width:100%;height:1rem;line-height:1rem;font-size:0.2rem;border-bottom:1px solid #EDEDED;z-index:999;position:fixed;top:0;background-color:#fff;}
			.car_list_box .car_list_nav ul{width:100%;height:1rem;}
			.car_list_box .car_list_nav ul li{height:1rem;width:20%;text-align:center;}
			.car_list_box .car_list_nav ul li b{display: inline-block;height:1rem;box-sizing: border-box;}
			.car_list_box .car_list_nav ul .on{border-bottom:2px solid #000;}
			.car_list{height:100%;z-index: 999;}
			.car_list_nav{}
		</style>
	</head>
	<body>
		<div class="max_width">
			<div class="box">
				<div class="loan_box fl">
					<div class="loan_fill">
						<ul>
							<li>
								<span>借款金额</span>
								<input type="text" placeholder="您需要多少资金？"/>
							</li>
							<li class="car_btn">
								<span>车辆型号</span>
								<b>请选择车辆型号信息</b>
								<i> > </i>
							</li>
							<li class="loan_litxt">
								<p>填写个人信息，便于拓道安排专人为您提供服务</p>
							</li>
							<li>
								<span>您的姓名</span>
								<input type="text" placeholder="请填写您的姓名？"/>
							</li>
							<li>
								<span>手机号</span>
								<input type="text" placeholder="请输入手机号，便于我们联系您"/>
							</li>
							<li>
								<span>短信验证码</span>
								<input type="text" placeholder="请输入收到短信的验证码"/>
								<span class="code_btn">| 获取</span>
							</li>
							<li>
								<span>所在地区</span>
								<b>请选择您所在的城市</b>
								<i> > </i>
							</li>
						</ul>
						<div class="sub_loan">
							<a href="###">提交申请</a>
						</div>
					</div>
				</div>
				<div class="car_list_box fl">
					<div class="car_list_nav">
						<ul>
							<li class="fl car_bra">
								<b class="on">品牌</b>
							</li>
							<li class="fl car_ty">
								<b>车系</b>
							</li>
							<li class="fr">
								<a href="javascript:;">确定</a>
							</li>
						</ul>
					</div>
						<div class="car_list car_list-hook">
							<div class="scroller-hook">
								<div class="cities cities-hook"></div>
							</div>
							<div class="shortcut shortcut-hook"></div>
						</div>
						<div class="car_list_bot">
							<ul class="car_list_botul">
								
							</ul>
						</div>
				</div>
			</div>
		</div>		
	</body>
</html>
<script src="car/bscroll.min.js"></script>
<script src="car/city.js"></script>
<script>
	$(function(){
		$(".car_btn").on("click",function(){
			$(".box").css("left","-100%");
		})
		var cityWrapper = document.querySelector('.car_list-hook');
		var cityScroller = document.querySelector('.scroller-hook');
		var cities = document.querySelector('.cities-hook');
		var shortcut = document.querySelector('.shortcut-hook');
		var car_list_botul = document.querySelector('.car_list_botul')
		var scroll;
		var shortcutList = [];
		var anchorMap = {};

		function initCities() {
			var y = 0,titleHeight = 28,itemHeight = 44,lists = '';
			var lists = '';
			var ul = '<ul class="shortcut_ul">';
		   $.ajax({
				 url: 'car/city.json',
				 type: 'get',
				 success:function(data){
					$.each(data,function(i,item){
						var name = item.name;

						lists += '<div class="title">'+name+'</div>'; 
		    				lists += '<ul>';
		    				$.each(item.carlist,function(k,items){
							var txts = items.series;
		    					lists += '<li class="item" data-name="'+ items.name +'" data-id="'+ items.carid +'">' + items.name +'</li>';
		    					$(document).on("click",".item",function(e){
									var txt = e.target.getAttribute('data-name');
					    			$(".car_list").hide();
					    			$(".car_list_bot").show();
									if(txt == items.name){
		    							for(var i=0;i<txts.length;i++){
		    								var lis = "<li>" + txts[i] + "</li>"
		    								$(".car_list_botul").append(lis);
		    							}
									};
									$(".car_list_nav li b").removeClass("on");
									$(".car_list_nav .car_ty b").addClass("on");
										scroll = new window.BScroll(car_list_botul, {
									   		probeType: 3,
									   		click:true
									 	});
										scroll.scrollTo(0, 0);

								})

		    				});
		    				lists += '</ul>';
					    var name = item.name.substr(0, 1);
					    shortcutList.push(name);
					    ul += '<li data-anchor="'+name+'" class="item">'+name+'</li>';
					    var len = item.carlist.length;
					    anchorMap[name] = y;
					    y -= titleHeight + len * itemHeight;
					 
					});
					ul += '</ul><div class="jump-tips"></div>';

					cities.innerHTML = lists;
					shortcut.innerHTML = ul;
					shortcut.style.top = (cityWrapper.clientHeight - shortcut.clientHeight) / 2 + 'px';
					
				  	scroll = new window.BScroll(cityWrapper, {
				   		probeType: 3,
				   		click:true
				 	 });
					  scroll.scrollTo(0, 0);

					
				 }
			});	 
		};
//		//bind Event
		function bindEvent() {
		  var touch = {};
		  var firstTouch;
		  shortcut.addEventListener('touchstart', function (e) {
		    var anchor = e.target.getAttribute('data-anchor');
		    firstTouch = e.touches[0];
		    touch.y1 = firstTouch.pageY;
		    touch.anchor = anchor;
		    $(".jump-tips").show();
		    $(".jump-tips").html(anchor);
		    scrollTo(anchor);
			e.preventDefault();
		   	e.stopPropagation();
		  });
		   shortcut.addEventListener('touchend', function (e) {
		    	$(".jump-tips").hide();
		  });
		
		  shortcut.addEventListener('touchmove', function (e) {
		    firstTouch = e.touches[0];
		    touch.y2 = firstTouch.pageY;
		    var anchorHeight = 16;
		    var delta = (touch.y2 - touch.y1) / anchorHeight | 0;
		    var anchor = shortcutList[shortcutList.indexOf(touch.anchor) + delta];
		    $(".jump-tips").html(anchor);
		    scrollTo(anchor);
		    e.preventDefault();
		    e.stopPropagation();
		
		  });
		
		  function scrollTo(anchor) {
		    var maxScrollY = cityWrapper.clientHeight - cityScroller.clientHeight;
		    var y = Math.min(0, Math.max(maxScrollY, anchorMap[anchor]));
		    if (typeof y !== 'undefined') {
		      scroll.scrollTo(0, y);
		    }
		  }
		}
		
		initCities();
		bindEvent();
		$(".car_list_nav .car_bra").on("click",function(){
			$(this).find("b").addClass("on");
			$(".car_list_nav .car_ty b").removeClass("on");
			$(".car_list").show();
			$(".car_list_bot").hide();
			$(".car_list_botul li").remove()

		})
	})
	
</script>